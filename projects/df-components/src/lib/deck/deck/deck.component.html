<ng-template #cardActions let-card>
  <div
    class="df-card__actions df-card--border"
    *ngIf="card?.cardType == cardType.Parent || card?.actions?.length > 0"
  >
    <a
      *ngFor="let action of card?.actions"
      mdc-button
      dense
      (click)="onAction.emit(action)"
      >{{ action.title }}</a
    >
    <a
      *ngIf="card?.cardType == cardType.Parent"
      (click)="onAction.emit(card)"
      mdc-button
      dense
      >More</a
    >
    <div class="df-layout-spacer"></div>
  </div>
</ng-template>

<ng-template #editActions let-card>
    <div
      class="df-card__actions df-card--border"
      *ngIf="selectedCard && selectedCard.id === card.id"
    >
    <a
       
    mdc-button
    dense
    
    >cancel</a
  >
      <a
       
        mdc-button
        dense
        
        >SAVE</a
      >
   
      <div class="df-layout-spacer"></div>
    </div>
  </ng-template>

<ng-template #cardMenu let-card>
  <div *ngIf="!readOnly" class="df-card__menu {{ card?.colour }} transparent">
    <a (click)="onEdit.emit(card)" mdc-icon-button dense icon="edit"></a>
  </div>
</ng-template>

<ng-template #cardTitle let-card>
  <div class="df-card__title {{ card?.colour }}" (click)="navigate(card)">
    <h2 class="df-card__title-text">{{ card?.title }}</h2>
  </div>
</ng-template>

<ng-template #cardSupportingText let-card>
  <div
    *ngIf="card?.supportingText"
    class="df-card__supporting-text"
    [innerHtml]="card?.supportingText"
    (click)="navigate(card)"
  ></div>
</ng-template>

<ng-template #cardData let-card>
  <div *ngIf="card?.data" [innerHtml]="card?.data"></div>
</ng-template>

<ng-template #standardCard let-card>
    <ng-container *ngIf="selectedCard && selectedCard.id === card.id">
        <p>EDITING</p>
      </ng-container>
  <ng-container
    *ngTemplateOutlet="cardTitle; context: { $implicit: card }"
  ></ng-container>
  <ng-container
    *ngTemplateOutlet="cardSupportingText; context: { $implicit: card }"
  ></ng-container>
  <ng-container
    *ngTemplateOutlet="cardActions; context: { $implicit: card }"
  ></ng-container>
  <ng-container
  *ngTemplateOutlet="editActions; context: { $implicit: card }"
></ng-container>
  <ng-container
    *ngTemplateOutlet="cardMenu; context: { $implicit: card }"
  ></ng-container>

-
</ng-template>

<ng-template #embedCard let-card>
  <ng-container
    *ngTemplateOutlet="cardTitle; context: { $implicit: card }"
  ></ng-container>
  <ng-container
    *ngTemplateOutlet="cardData; context: { $implicit: card }"
  ></ng-container>
  <ng-container
    *ngTemplateOutlet="cardMenu; context: { $implicit: card }"
  ></ng-container>
</ng-template>

<ng-template #imageCard let-card>

  <ng-container
    *ngTemplateOutlet="cardTitle; context: { $implicit: card }"
  ></ng-container>
  <div class="df-card__media" (click)="navigate(card)">
      <img class="deck-image" src="{{ card?.media?.url }}" border="0" alt="" />
    </div>
  <ng-container
    *ngTemplateOutlet="cardSupportingText; context: { $implicit: card }"
  ></ng-container>
  <ng-container
    *ngTemplateOutlet="cardActions; context: { $implicit: card }"
  ></ng-container>
  <ng-container
    *ngTemplateOutlet="cardMenu; context: { $implicit: card }"
  ></ng-container>
</ng-template>

<ng-template #parentCard let-card>
  <ng-container
    *ngTemplateOutlet="cardTitle; context: { $implicit: card }"
  ></ng-container>
  <ng-container
    *ngTemplateOutlet="cardSupportingText; context: { $implicit: card }"
  ></ng-container>
  <ng-container
    *ngTemplateOutlet="cardActions; context: { $implicit: card }"
  ></ng-container>
  <ng-container
    *ngTemplateOutlet="cardMenu; context: { $implicit: card }"
  ></ng-container>
</ng-template>

<ng-template #audioCard let-card>
  <ng-container
    *ngTemplateOutlet="cardTitle; context: { $implicit: card }"
  ></ng-container>
  <ng-container
    *ngTemplateOutlet="cardSupportingText; context: { $implicit: card }"
  ></ng-container>
  <audio name="media" controls style="width: 100%">
    <source [attr.src]="card?.media?.url" [attr.type]="card?.media?.type" />
    Your browser does not support the audio tag.
  </audio>
  <ng-container
    *ngTemplateOutlet="cardMenu; context: { $implicit: card }"
  ></ng-container>
</ng-template>

<ng-template #videoCard let-card>
  <ng-container
    *ngTemplateOutlet="cardTitle; context: { $implicit: card }"
  ></ng-container>
  <video controls>
      <source [attr.src]="card?.media?.url" [attr.type]="card?.media?.type" />
    Your browser does not support the video tag.    </video>
  <ng-container
    *ngTemplateOutlet="cardMenu; context: { $implicit: card }"
  ></ng-container>
</ng-template>

<ng-template #markdownCard let-card>
  <ng-container
    *ngTemplateOutlet="cardTitle; context: { $implicit: card }"
  ></ng-container>
  <ng-container
    *ngTemplateOutlet="cardSupportingText; context: { $implicit: card }"
  ></ng-container>
  <ng-container
    *ngTemplateOutlet="cardActions; context: { $implicit: card }"
  ></ng-container>
  <ng-container
    *ngTemplateOutlet="cardMenu; context: { $implicit: card }"
  ></ng-container>
</ng-template>

<ng-template #refinerCard let-card>
  <ng-container
    *ngTemplateOutlet="cardTitle; context: { $implicit: card }"
  ></ng-container>
  <ng-container
    *ngTemplateOutlet="cardSupportingText; context: { $implicit: card }"
  ></ng-container>
  <ng-container
    *ngTemplateOutlet="cardActions; context: { $implicit: card }"
  ></ng-container>
  <ng-container
    *ngTemplateOutlet="cardMenu; context: { $implicit: card }"
  ></ng-container>
</ng-template>

<ng-template #chartCard let-card>
  <ng-container
    *ngTemplateOutlet="cardTitle; context: { $implicit: card }"
  ></ng-container>
  <canvas
    baseChart
    width="400"
    height="400"
    [datasets]="card?.data?.chartData"
    [labels]="card?.data?.chartLabels"
    [options]="card?.data?.chartOptions"
    [colors]="card?.data?.chartColors"
    [legend]="card?.data?.chartLegend"
    [chartType]="card?.data?.chartType"
  ></canvas>
  <ng-container
    *ngTemplateOutlet="cardSupportingText; context: { $implicit: card }"
  ></ng-container>
  <ng-container
    *ngTemplateOutlet="cardActions; context: { $implicit: card }"
  ></ng-container>
  <ng-container
    *ngTemplateOutlet="cardMenu; context: { $implicit: card }"
  ></ng-container>
</ng-template>

<section class="deck df-grid section--center">
  <div
    *ngFor="let card of cards"
    [ngSwitch]="card.cardType"
    class="df-card df-cell df-cell--{{ card?.size }}-col df-shadow--4dp"
  >
    <ng-container *ngSwitchCase="cardType.Image">
      <ng-container
        *ngTemplateOutlet="imageCard; context: { $implicit: card }"
      ></ng-container>
    </ng-container>
    <ng-container *ngSwitchCase="cardType.Parent">
      <ng-container
        *ngTemplateOutlet="parentCard; context: { $implicit: card }"
      ></ng-container>
    </ng-container>
    <ng-container *ngSwitchCase="cardType.Chart">
      <ng-container
        *ngTemplateOutlet="chartCard; context: { $implicit: card }"
      ></ng-container>
    </ng-container>
    <ng-container *ngSwitchCase="cardType.Markdown">
      <ng-container
        *ngTemplateOutlet="markdownCard; context: { $implicit: card }"
      ></ng-container>
    </ng-container>
    <ng-container *ngSwitchCase="cardType.Embed">
      <ng-container
        *ngTemplateOutlet="embedCard; context: { $implicit: card }"
      ></ng-container>
    </ng-container>
    <ng-container *ngSwitchCase="cardType.Audio">
      <ng-container
        *ngTemplateOutlet="audioCard; context: { $implicit: card }"
      ></ng-container>
    </ng-container>
    <ng-container *ngSwitchCase="cardType.Video">
      <ng-container
        *ngTemplateOutlet="videoCard; context: { $implicit: card }"
      ></ng-container>
    </ng-container>
    <ng-container *ngSwitchCase="cardType.Refiner">
      <ng-container
        *ngTemplateOutlet="refinerCard; context: { $implicit: card }"
      ></ng-container>
    </ng-container>  
    <ng-container *ngSwitchDefault>
      <ng-container
        *ngTemplateOutlet="standardCard; context: { $implicit: card }"
      ></ng-container>
    </ng-container>
  </div>
</section>
